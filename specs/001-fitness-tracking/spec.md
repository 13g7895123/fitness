# 功能規格：健身紀錄系統

**功能分支**: `001-fitness-tracking`  
**建立日期**: 2025-11-02  
**狀態**: 草稿  
**輸入描述**: "健身紀錄系統 - 使用者可以記錄、查看和管理每日健身數據，包括運動種類、時間、消耗卡路里，並可查看週期性統計和趨勢圖表"  
**語言**: 繁體中文 (zh-TW) - 所有內容必須使用繁體中文（依據憲章規定）

## 澄清事項

### 會議記錄 2025-11-02

- Q: 系統應該使用哪種使用者身份驗證方式？ → A: LINE 登入
- Q: 單次運動紀錄的運動時間和消耗卡路里應該設定什麼合理範圍？ → A: 運動時間 1-480 分鐘、卡路里 1-5000 大卡
- Q: 系統計算「每週」統計時，一週應該從哪一天開始？ → A: 週一（Monday）為一週的開始
- Q: 使用者新增健身紀錄時，消耗卡路里的數值應該如何處理？ → A: 系統根據運動項目和時間自動計算，使用者可手動調整
- Q: 當使用者在同一天記錄多筆相同運動項目時，系統應該如何處理？ → A: 分別顯示各筆紀錄，統計時自動加總
- Q: 系統如何自動計算消耗卡路里？有什麼計算公式？ → A: 使用代謝當量（MET）公式：**消耗卡路里（大卡）= MET 值 × 體重（公斤）× 運動時長（小時）**。各運動項目的預設 MET 值：跑步=8.0、游泳=7.0、騎自行車=6.0、重量訓練=5.0、瑜伽=3.0、皮拉提斯=3.5、其他=4.0。若使用者未填寫體重，系統使用預設值 70 公斤。計算後的數值為建議值，使用者可依實際情況手動調整

## 使用者場景與測試 *(必填)*

### 使用者故事 1 - 查看當前健身紀錄 (優先級: P1)

使用者進入首頁後，可以立即看到本週的健身紀錄摘要，包括總運動時間、消耗卡路里，以及與上週的比較數據。使用者可以快速了解自己本週的運動表現。

**優先級理由**: 這是使用者最基本且最常用的功能，能讓使用者快速掌握當前運動狀況，是最小可行產品（MVP）的核心價值。

**獨立測試**: 可透過登入系統後查看首頁，驗證是否正確顯示本週紀錄摘要和週比較數據，即使沒有其他功能也能提供價值。

**驗收場景**:

1. **給定** 使用者已登入系統且本週有健身紀錄，**當** 使用者進入首頁，**則** 系統顯示本週總運動時間、總消耗卡路里、運動天數
2. **給定** 使用者已登入系統且上週有紀錄，**當** 使用者查看首頁，**則** 系統顯示本週與上週的比較數據（增加或減少的百分比）
3. **給定** 使用者本週尚無健身紀錄，**當** 使用者進入首頁，**則** 系統顯示提示訊息鼓勵使用者開始記錄運動
4. **給定** 使用者在首頁，**當** 使用者點擊切換到「每月檢視」，**則** 系統顯示本月的健身紀錄摘要與上月比較
5. **給定** 使用者在首頁，**當** 使用者點擊切換到「每年檢視」，**則** 系統顯示本年的健身紀錄摘要與去年比較

---

### 使用者故事 2 - 新增與管理每日健身紀錄 (優先級: P2)

使用者可以新增每日的健身紀錄，記錄包括運動種類、運動時間、消耗卡路里等詳細資訊。使用者也可以編輯或刪除已新增的紀錄，確保資料的準確性。

**優先級理由**: 這是資料輸入的核心功能，必須在查看功能之後實作，才能讓使用者建立自己的健身數據。

**獨立測試**: 可透過新增一筆健身紀錄、編輯該紀錄、刪除該紀錄等操作，驗證完整的 CRUD 功能，不依賴其他進階功能。

**驗收場景**:

1. **給定** 使用者在首頁，**當** 使用者點擊「新增健身紀錄」，**則** 系統顯示新增紀錄表單，包含日期、運動項目、運動時間、消耗卡路里等欄位
2. **給定** 使用者填寫完新增表單，**當** 使用者送出表單，**則** 系統儲存紀錄並顯示成功訊息，首頁數據自動更新
3. **給定** 使用者有已新增的健身紀錄，**當** 使用者點擊某筆紀錄的「編輯」按鈕，**則** 系統顯示編輯表單，預填原有資料
4. **給定** 使用者修改編輯表單內容，**當** 使用者儲存變更，**則** 系統更新該筆紀錄並顯示成功訊息
5. **給定** 使用者有已新增的健身紀錄，**當** 使用者點擊「刪除」並確認，**則** 系統移除該筆紀錄並更新統計數據
6. **給定** 使用者新增紀錄時未填寫必填欄位，**當** 使用者送出表單，**則** 系統顯示錯誤訊息並標示必填欄位
7. **給定** 使用者選擇運動項目，**當** 系統顯示運動項目選單，**則** 包含使用者自訂的運動項目與系統預設項目

---

### 使用者故事 3 - 查看每週詳細健身數據 (優先級: P3)

使用者可以點擊週統計數據，深入查看該週每天的詳細健身資訊，了解每日的運動種類、時間分配和卡路里消耗明細。

**優先級理由**: 這是進階查看功能，讓使用者能深入分析每日數據，但需要先有基本的查看和新增功能作為基礎。

**獨立測試**: 可透過點擊週統計進入每日明細頁面，驗證能正確顯示該週七天的詳細數據，不需要其他進階分析功能。

**驗收場景**:

1. **給定** 使用者在首頁查看本週統計，**當** 使用者點擊本週統計數據，**則** 系統顯示本週每天（週一至週日）的詳細健身紀錄
2. **給定** 使用者查看每日明細，**當** 系統顯示某天的資料，**則** 包含該天所有運動項目、各項運動時間、消耗卡路里
3. **給定** 使用者查看每日明細，**當** 某天沒有健身紀錄，**則** 系統顯示「當日未記錄」訊息
4. **給定** 使用者在每日明細頁面，**當** 使用者點擊某筆運動紀錄，**則** 可以直接進入編輯模式

---

### 使用者故事 4 - 設定與追蹤運動目標 (優先級: P4)

使用者可以為自己設定每週的運動目標（如每週運動天數、總運動時間、總消耗卡路里），系統會即時顯示目標達成進度，幫助使用者保持運動動力。

**優先級理由**: 這是激勵功能，能提升使用者持續使用的動力，但需要先有基本的記錄和查看功能。

**獨立測試**: 可透過設定週目標、記錄運動、查看達成進度等操作，驗證目標追蹤功能完整運作，不依賴趨勢圖表等其他功能。

**驗收場景**:

1. **給定** 使用者在首頁，**當** 使用者點擊「設定目標」，**則** 系統顯示目標設定表單，包含每週運動天數、總運動時間、總消耗卡路里等選項
2. **給定** 使用者設定好週目標，**當** 使用者儲存設定，**則** 系統在首頁顯示目標達成進度條或百分比
3. **給定** 使用者有設定目標且本週有運動紀錄，**當** 使用者查看首頁，**則** 系統即時計算並顯示目標完成度（例如：已達成 60%）
4. **給定** 使用者達成週目標，**當** 系統偵測到目標達成，**則** 顯示祝賀訊息或成就徽章
5. **給定** 使用者設定每日目標，**當** 使用者查看每日明細，**則** 系統顯示該日目標達成狀況

---

### 使用者故事 5 - 查看歷史趨勢圖表 (優先級: P5)

使用者可以透過視覺化圖表查看歷史健身數據的趨勢，包括運動時間、消耗卡路里的變化曲線，幫助使用者了解長期運動表現和改善方向。

**優先級理由**: 這是進階分析功能，提供長期數據洞察，但需要累積足夠的歷史資料才有意義，因此優先級較低。

**獨立測試**: 可透過查看趨勢圖表頁面，驗證能正確顯示折線圖、柱狀圖等視覺化數據，不需要其他複雜分析功能。

**驗收場景**:

1. **給定** 使用者有至少四週的健身紀錄，**當** 使用者進入「趨勢分析」頁面，**則** 系統顯示近四週的運動時間折線圖
2. **給定** 使用者查看趨勢圖表，**當** 使用者選擇「消耗卡路里」指標，**則** 系統顯示卡路里消耗的趨勢變化
3. **給定** 使用者查看趨勢圖表，**當** 使用者選擇「每月檢視」，**則** 系統顯示近 12 個月的月度統計圖表
4. **給定** 使用者查看趨勢圖表，**當** 使用者點擊圖表上的資料點，**則** 系統顯示該時間點的詳細數據
5. **給定** 使用者歷史資料不足，**當** 使用者進入趨勢分析頁面，**則** 系統顯示提示訊息說明需要更多資料才能產生趨勢

---

### 使用者故事 6 - 自訂運動項目與器材 (優先級: P6)

使用者可以建立和管理自己的運動項目清單，為每個運動項目設定名稱、選擇使用的運動器材，並為器材加上說明，讓健身紀錄更加個人化和詳細。

**優先級理由**: 這是個人化設定功能，能提升使用者體驗，但不是核心記錄功能的必要條件，可以最後實作。

**獨立測試**: 可透過新增運動項目、設定器材、編輯說明等操作，驗證自訂功能完整運作，不影響基本的健身記錄功能。

**驗收場景**:

1. **給定** 使用者在設定頁面，**當** 使用者點擊「管理運動項目」，**則** 系統顯示目前所有運動項目清單（包含系統預設和使用者自訂）
2. **給定** 使用者在運動項目管理頁面，**當** 使用者點擊「新增運動項目」，**則** 系統顯示表單，包含項目名稱、類別、預設消耗卡路里等欄位
3. **給定** 使用者新增或編輯運動項目，**當** 使用者選擇「使用器材」選項，**則** 系統顯示器材清單供選擇
4. **給定** 使用者選擇器材，**當** 使用者點擊器材旁的「說明」按鈕，**則** 系統顯示該器材的使用說明或注意事項
5. **給定** 使用者自訂運動項目，**當** 使用者記錄健身時選擇運動項目，**則** 下拉選單包含系統預設項目和使用者自訂項目
6. **給定** 使用者有自訂運動項目，**當** 使用者刪除該項目，**則** 系統檢查是否有紀錄使用該項目，若有則警告無法刪除或建議轉換為其他項目

---

### 邊界案例

- 使用者在同一天記錄多筆相同運動項目時，系統分別顯示各筆紀錄，統計時自動加總（例：早上跑步 30 分鐘、晚上跑步 40 分鐘，當日總計顯示 70 分鐘）
- 使用者輸入超出範圍的運動時間（>480 分鐘）或卡路里數值（>5000 大卡）時，系統顯示錯誤訊息提示合理範圍
- 使用者修改過去日期的健身紀錄時，週統計、月統計、年統計如何即時更新？
- 使用者刪除某週的所有紀錄後，週比較功能如何顯示（上週有資料但本週無）？
- 使用者設定的運動目標不合理（例如每週運動 7 天但每天 10 小時）時，系統如何提示？
- 使用者在月底或年底切換檢視時，如何處理跨月、跨年的週統計？（週的定義：週一至週日，跨月的週歸屬於包含較多天數的月份）
- 使用者刪除正在使用的自訂運動項目時，已有的歷史紀錄如何處理？
- 系統預設運動項目與使用者自訂項目重名時，如何區分和顯示？

## 需求規格 *(必填)*

### 功能需求

**資料查看與統計**

- **FR-001**: 系統必須在首頁顯示當前週期（週/月/年）的健身紀錄摘要，包含總運動時間、總消耗卡路里、運動天數
- **FR-002**: 系統必須提供週、月、年三種時間週期切換，使用者可自由選擇檢視方式
- **FR-003**: 系統必須在顯示當前週期統計時，同步顯示與上一週期（上週/上月/去年）的比較數據，包含增減百分比
- **FR-004**: 系統必須自動計算每週、每月、每年的總運動時間與總消耗卡路里（每週以週一為起始日，週日為結束日）
- **FR-005**: 系統必須允許使用者點擊週統計數據，查看該週每天（週一至週日）的詳細健身紀錄
- **FR-006**: 系統必須在每日明細中顯示該日所有運動紀錄（各筆分別顯示，即使相同運動項目）、各筆運動時間、消耗卡路里，並顯示當日總計

**資料新增與管理**

- **FR-007**: 系統必須提供新增健身紀錄功能，記錄欄位包含：
  - 日期（必填，Date 型別，不可為未來日期）
  - 運動項目（必填，從系統預設或使用者自訂項目中選擇）
  - 運動時長（必填，整數，單位為分鐘，範圍 1-480）
  - 消耗卡路里（大卡，系統根據運動項目 MET 值和體重自動計算預設值，使用者可手動調整，範圍 1-5000）
  - 體重（選填，decimal 型別，單位為公斤，用於卡路里計算，未填寫時使用預設值 70 公斤）
  - 運動器材（選填，從器材清單中選擇）
  - 備註（選填，文字，最多 500 字）
- **FR-008**: 系統必須允許使用者編輯已新增的健身紀錄，可修改所有欄位內容
- **FR-009**: 系統必須允許使用者刪除已新增的健身紀錄，刪除前須顯示確認對話框
- **FR-010**: 系統必須在使用者新增或修改紀錄後，即時更新所有相關統計數據（日、週、月、年）
- **FR-011**: 系統必須驗證使用者輸入的資料格式，確保運動時間為 1-480 分鐘、消耗卡路里為 1-5000 大卡、日期格式正確、必填欄位完整

**運動項目與器材管理**

- **FR-012**: 系統必須提供運動項目管理功能，使用者可新增、編輯、刪除自訂運動項目，每個運動項目包含預設 MET 值（代謝當量，用於卡路里計算，參見澄清事項）
- **FR-013**: 系統必須在新增運動紀錄時，提供運動項目下拉選單，包含系統預設項目和使用者自訂項目
- **FR-014**: 系統必須允許使用者為運動項目選擇或關聯運動器材
- **FR-015**: 系統必須允許使用者為運動器材新增說明文字，描述器材用途或使用方法
- **FR-016**: 系統必須在使用者刪除自訂運動項目前，檢查是否有歷史紀錄使用該項目，若有則提示警告訊息

**目標設定與追蹤**

- **FR-017**: 系統必須提供運動目標設定功能，使用者可設定每週運動目標，包含：每週運動天數、每週總運動時間、每週總消耗卡路里
- **FR-018**: 系統必須在首頁即時顯示使用者的目標達成進度，以百分比或進度條方式呈現
- **FR-019**: 系統必須在使用者達成設定目標時，顯示祝賀訊息或成就提示
- **FR-020**: 系統必須允許使用者隨時修改或取消運動目標設定

**趨勢分析與視覺化**

- **FR-021**: 系統必須提供歷史趨勢圖表功能，視覺化呈現運動時間和消耗卡路里的變化趨勢
- **FR-022**: 系統必須支援多種圖表檢視方式，包含折線圖（趨勢）和柱狀圖（對比）
- **FR-023**: 系統必須允許使用者在趨勢圖表中選擇不同時間範圍（近 4 週、近 12 個月、全部歷史）
- **FR-024**: 系統必須在使用者點擊圖表資料點時，顯示該時間點的詳細數據
- **FR-025**: 系統必須在歷史資料不足時（少於 2 週），顯示提示訊息說明需要更多資料才能產生有意義的趨勢

**使用者體驗**

- **FR-026**: 所有使用者介面文字、按鈕標籤、錯誤訊息、通知訊息必須使用繁體中文
- **FR-027**: 系統必須在資料載入時顯示載入指示器，避免使用者誤以為系統無反應
- **FR-028**: 系統必須在使用者執行新增、編輯、刪除等操作成功後，顯示明確的成功訊息
- **FR-029**: 系統必須在發生錯誤時，顯示友善的錯誤訊息，並提供可能的解決建議
- **FR-030**: 系統必須支援響應式設計，在手機（320px+）、平板（768px+）、桌面（1024px+）裝置上正常顯示

**身份驗證與授權**

- **FR-031**: 系統必須支援 LINE 登入作為身份驗證方式
- **FR-032**: 系統必須在使用者首次使用 LINE 登入時，建立使用者帳戶並儲存 LINE 使用者 ID
- **FR-033**: 系統必須在使用者登入後，維持登入狀態，使用者無需每次開啟應用程式都重新登入
- **FR-034**: 系統必須提供登出功能，允許使用者主動登出帳戶
- **FR-035**: 系統必須確保每位使用者只能查看和管理自己的健身紀錄，不能存取其他使用者的資料

### 關鍵實體

- **健身紀錄 (WorkoutRecord)**: 代表一筆使用者的運動記錄，包含日期、運動項目參照、運動時長（分鐘）、消耗卡路里、備註等屬性
- **運動項目 (ExerciseType)**: 代表一種運動類別，包含項目名稱、類別（有氧/重訓/伸展等）、是否為使用者自訂、預設卡路里消耗率等屬性
- **運動器材 (Equipment)**: 代表運動使用的器材，包含器材名稱、說明文字、關聯的運動項目清單等屬性
- **運動目標 (WorkoutGoal)**: 代表使用者設定的運動目標，包含目標類型（週/月）、目標數值（天數/時間/卡路里）、開始日期、是否啟用等屬性
- **使用者 (User)**: 代表使用本系統的使用者，與健身紀錄、自訂運動項目、運動目標有一對多關係

## 成功標準 *(必填)*

### 可衡量的成果

- **SC-001**: 使用者能在 3 秒內完成新增一筆健身紀錄（從點擊新增按鈕到儲存成功）
- **SC-002**: 首頁載入並顯示本週健身摘要的時間少於 2 秒
- **SC-003**: 90% 的使用者能在首次使用時，不需額外說明即可成功新增第一筆健身紀錄
- **SC-004**: 使用者能在切換週/月/年檢視時，系統在 1 秒內完成統計數據更新
- **SC-005**: 趨勢圖表載入和渲染時間少於 3 秒（包含 12 個月的歷史資料）
- **SC-006**: 系統在使用者修改歷史紀錄後，能在 2 秒內重新計算並更新所有相關統計數據
- **SC-007**: 使用者能夠在 5 次點擊內完成從首頁到新增健身紀錄、填寫資料、儲存的完整流程
- **SC-008**: 80% 的使用者在使用目標追蹤功能後，每週運動記錄次數提升 30% 以上
- **SC-009**: 系統能夠支援使用者累積至少 2 年的健身紀錄資料，而不影響查詢和統計效能
- **SC-010**: 使用者對於健身紀錄管理功能的滿意度達到 4.0 分以上（滿分 5 分）

## 假設與限制

### 假設

- 使用者具備基本的智慧型手機或電腦操作能力
- 使用者會誠實且準確地記錄自己的運動數據
- 使用者了解基本的運動術語（如有氧運動、重量訓練等）
- 運動項目的卡路里消耗計算採用業界標準公式或參考值
- 使用者會定期（每日或每週）使用系統記錄運動資料

### 限制

- 本階段不包含自動同步運動穿戴裝置（如智慧手錶）的數據
- 本階段不包含社群分享或好友互動功能
- 本階段不包含專業運動教練建議或 AI 訓練計畫生成
- 本階段不包含營養飲食記錄與追蹤功能
- 圖表視覺化功能僅提供基本的折線圖和柱狀圖，不包含複雜的多維度分析圖表
